[[#if (urlParam "details")]]
<div class="detail-sidebar-content">
    [[#block "detailsResourceHeader"]]
    <div style="display: flex; margin-bottom: 18px;">

        <mp-resource-thumbnail iri='[[this]]' class='detail-img'>
            <mp-resource-thumbnail-fallback>
                <with-types iri='[[this]]'
                        template='{{> noImage}}'
                        [[> rsp:TypeMappings]]     >
                    <template id="noImage">
                        <span class="rs-icon {{getValueByKey typeToImage allTypes 'rs-icon-no-image'}} detail-icon-noimg" alt="{{directTypesLabels}}" title='{{directTypesLabels}}'></span>
                    </template>
                </with-types>
            </mp-resource-thumbnail-fallback>
        </mp-resource-thumbnail>

        <div style="max-width: 70%;">
            
            <!-- <mp-draggable iri='[[this]]'> -->
                <div class="rs-draggable-container">
                    <semantic-query query='SELECT ?type ?typeLabel WHERE {
                                            <[[this]]> a ?type .
                                            ?type rdfs:label ?typeLabel .
                                            FILTER (lang(?typeLabel) = "en")}'
                        template='{{> resourceType }}'>
                        <template id='resourceType'>
                            <div class="detail-type">
                                {{#each bindings}}{{typeLabel.value}}{{#if @last}}{{else}}, {{/if}}{{/each}}
                            </div>
                        </template>
                    </semantic-query>
            
                    <mp-label iri='[[this]]' class="detail-label"></mp-label>
                </div>
            <!-- </mp-draggable> -->

            <mp-copy-to-clipboard text='[[this]]'>
                <div class="rs-copy-IRI">Copy resource IRI</div>
            </mp-copy-to-clipboard>
                
        </div>

    </div>
    [[/block]]
  
    <bs-tabs class="details-tabs">
    [[#if withSummary]]
        <bs-tab title='Summary' event-key='summary' mount-on-enter=true>
            <div class="rs-summary-table table-responsive rs-object-dataset--table">
                <table class="table table-hover">
                [[#block "summary"]]
                <tbody>
                    <tr>
                    <td>No further data available</td>
                    <td></td>
                    </tr>
                </tbody>
                [[/block]]
                </table>
            </div>
        </bs-tab>
    [[/if]]
        <bs-tab title='Raw data' event-key='raw-data' mount-on-enter=true class="rawdata-tab">
            <mp-field-visualization subject='[[this]]'
                fields='[[fieldDefinitionsFromQuery (setQueryBindings "SELECT DISTINCT ?field WHERE {?resource ?field ?o . ?field a <http://www.researchspace.org/resource/system/fields/Field> } ORDER BY DESC(?field)" resource=this.iri) ]]'
                template='{{> template}}'>
            <template id="template">{{> rsp:ResourceFieldBasedVisualization subject="[[this]]"}}</template>
            </mp-field-visualization>
        </bs-tab>
  </bs-tabs>
</div>

[[else]]
<with-types fixed-key='resource-[[this]]' iri='[[this]]'
        template='{{> resource}}'
        [[> rsp:TypeMappings]]
>
    <template id='resource'>
        <div style="width: 100%;">
            [[#block "resourceHeader"]]
            [[!-- Resource Header --]]
                <div class="container-fluid rs-resource-header {{getValueByKey entityBgColor allTypes 'rs-entity-bg-thing'}}">
                    [[!-- Header top with draggable link --]]
                    <bs-row class="row-center">
                        <bs-col xs=1 lg=2 class="px-0">
                        </bs-col>

                        <bs-col xs=10 lg=8 class="rs-resource-header-content">

                            <div class="rs-resource-header-content-underline">
                                [[!-- defaul Header top customisable inline --]]
                                [[#block "resourceHeaderTop"]]
                                <div class="row d-flex rs-vertical-align">
                                    <mp-popover class="rs-resource-header-popover">
                                        <mp-popover-trigger placement="right" trigger='["hover"]' root-close='true'>
                                            <div class="col-auto rs-h4 rs-resource-header-top">
                                                <mp-draggable iri='[[this]]'>
                                                    <div>
                                                        <i class="rs-icon {{getValueByKey typeToIcon allTypes 'rs-icon-entity'}}"></i>
                                                        <span style="margin-left: 8px;">{{directTypesLabels}} -&nbsp;</span>
                                                        <mp-label iri='[[this]]'></mp-label>
                                                    </div>
                                                </mp-draggable>
                                            </div>
                                        </mp-popover-trigger>
                                        
                                        <mp-popover-content>
                                            <div>Drag and drop in the Clipboard</div>
                                        </mp-popover-content>
                                    
                                    </mp-popover>
                                </div>
                                [[/block]]

                                <div class="rs-body-s-I">Author resource content</div>
                            </div>

                        </bs-col>

                        <bs-col xs=1 lg=2 class="px-0" style="position: relative;">
                            <!-- <div class="rs-authoring-btnGroup">
                                <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                        urlqueryparam-view='knowledge-map' urlqueryparam-resource='[[this]]'>
                                    <button type="button" class="rs-authoring-btn" title="Author Resource in Knowledge Map">
                                        <i class="rs-icon rs-icon-diagram"></i>
                                    </button>
                                </semantic-link-container>
                                
                                <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                        urlqueryparam-view='entity-editor' urlqueryparam-resource='[[this]]'>
                                    <button type="button" class="rs-authoring-btn" title="Author Resource in Form">
                                        <i class="rs-icon rs-icon-form_edit"></i>
                                    </button>
                                </semantic-link-container>
                            </div> -->
                        </bs-col>

                    </bs-row> <!--  close row -->

                    [[!-- Header content with image (if available) and resource primary informations --]]
                    <div>
                        <bs-row class="row-center" style="padding:32px 0px 8px 0px;">
                            <bs-col xs=11 sm=10 lg=8 style="padding: 0px;">
                                <div class="row" style="height:100%;">
                                    <div class="col-xs-12 col-sm-6 rs-image-container">

                                        <div class="rs-resource-img__btngroup">

                                            <mp-overlay-dialog title="Resource Media" type="modal" class="modal-resourceMedia">
                                                <mp-overlay-dialog-trigger>
                                                    <button type="button" class="rs-resource-img__btn" title="Explore Media">
                                                        <i class="rs-icon rs-icon-expand_media"></i>
                                                    </button>
                                                </mp-overlay-dialog-trigger>
                                                <mp-overlay-dialog-content>
                                                  <mp-page-loader urlqueryparam-frame=true iri='http://www.researchspace.org/resource/ItemCardMedia' context='[[this]]'>
                                                  </mp-page-loader>
                                                </mp-overlay-dialog-content>
                                            </mp-overlay-dialog>

                                            <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                 urlqueryparam-view='iiif' urlqueryparam-resource='[[this]]'>
                                                <button type="button" class="rs-resource-img__btn" title="Explore Images in high resolution Viewer">
                                                    <i class="rs-icon rs-icon-image"></i>
                                                </button>
                                            </semantic-link-container>

                                            [[#if (hasPermission "forms:ldp:*")]]
                                            <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                 urlqueryparam-view='image-graph-authoring' urlqueryparam-resource='[[this]]'>
                                                <button type="button" class="rs-resource-img__btn" title="Annotate Images">
                                                    <i class="rs-icon rs-icon-area_annotation"></i>
                                                </button>
                                            </semantic-link-container>
                                            [[/if]]

                                        </div>
                                    
                                        [[#block "imageContent"]]
                                        <div class="carousel">
                                            <semantic-carousel
                                              query="SELECT DISTINCT ?imgUrl WHERE{
                                              {{subject}} crm:P56_bears_feature ?feat.             
                                              ?feat crm:P136_has_representation ?img_visual.
                                              ?img_visual crm:P129i_is_subject_of ?imgUrl
                                            }"
                                              options='{"fade": true, "lazyLoad": true }'
                                              tuple-template="{{> imageCarousel}}"
                                              no-result-template="{{> noImages}}"
                                            >
                                              <template id="imageCarousel">
                                                <img
                                                  style="object-fit: contain"
                                                  src="{{imgUrl.value}}"
                                        
                                                />
                                              </template>
                                      
                                              <template id="noImages">
                                                <div class="no-media">No images available</div>
                                              </template>
                                            </semantic-carousel>
                                          </div>
    
                                        [[/block]]
                                    </div>
                                    <div class="col-xs-6" style="padding: 1.8% 1.5% 1.5% 5%;">
                                        [[> resourceHeaderData image=true]]
                                    </div>
                                </div> <!--  close row -->
                            </bs-col>
                        </bs-row> <!--  close row -->
                    </div>
                </div>
            [[/block]]      

            [[!-- Tabs: Summary, raw data, Images, Annotation, Assertion, Related resources --]]
            <div class="container-fluid px-0">

                <bs-tab-container id="tab-container" class="rs-tabs"
                    default-active-key="[[#if withSummary]]summary[[else]]raw-data[[/if]]">
                    <div>
                        <bs-nav bs-style="tabs" class="{{getValueByKey entityBgColor allTypes 'rs-entity-bg-thing'}}">
                            [[#if withSummary]]
                            <bs-nav-item event-key="summary">Summary</bs-nav-item>
                            [[/if]]
                            <!-- <bs-nav-item event-key="raw-data">Raw data</bs-nav-item> -->
                            [[#if withGeoData]]
                            <bs-nav-item event-key="places">Related Places</bs-nav-item>
                            [[/if]]
                            
                            <!-- Disabled Several unused tabs -->

                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="media" disabled=true>Media</bs-nav-item>
                            [[/if]] -->
                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="annotations" disabled=true>Annotations
                                <span class="rs-badge rs-badge--info rs-body-s-M text-white"
                                    style="margin-left:8px;">0</span>
                                     <semantic-query query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                        ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                        template='{{#each bindings}}
                        <span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">{{count.value}}</span>
                        {{/each}}'
                        no-result-template='<span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">0</span>'
                        ></semantic-query>
                            </bs-nav-item>
                            [[/if]] -->
                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="assertions" disabled=true>Assertions
                                <span class="rs-badge rs-badge--info rs-body-s-M text-white"
                                    style="margin-left:8px;">0</span>
                                 <semantic-query query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                    ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                    template='{{#each bindings}}
                                    <span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">{{count.value}}</span>
                                    {{/each}}'
                                    no-result-template='<span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">0</span>'
                                    ></semantic-query> 
                            </bs-nav-item>
                            [[/if]] -->
                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="related" disabled=true>Explore Related</bs-nav-item>
                            [[/if]] -->
                        </bs-nav>

                        <bs-tab-content animation="true">
                            [[#if withSummary]]
                            <bs-tab-pane event-key="summary">
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            [[#block "instituteHeader"]]
                                            <span class="rs-h1 rs-section-header">Dataset</span>
                                            [[/block]]

                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">

                                            <div class="table-responsive rs-table rs-object-dataset--table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col" style="width: 30%">Field</th>
                                                            <th scope="col">Value</th>
                                                        </tr>
                                                    </thead>
                                                    [[#block "summary"]]
                                                    <tbody>
                                                        <tr>
                                                            <td>No further data available</td>
                                                            <td></td>
                                                        </tr>
                                                    </tbody>
                                                    [[/block]]
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->
                                </div> <!--  close container -->

                                [[#if (hasPermission "forms:ldp:*")]]
                                <div class="container-fluid rs-summary-section rs-background-p10">
                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Public Discussion</span>
                                            <span class="rs-body-xs-I rs-section-header">Documents the ongoing discussion
                                                about findings.
                                                <a style="padding-left:5px; text-decoration: underline;">Read more</a>
                                            </span>
                                        </bs-col>
                                        <bs-col xs=3 md=3 lg=2>
                                            <input type="text" placeholder="Assert new value..."
                                                class="rs-searchInput rs-body-s-M">
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                                            <div class="table-responsive rs-table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Field</th>
                                                            <th scope="col">Value</th>
                                                            <th scope="col">Annotation</th>
                                                            <th scope="col">Assertion</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>No data available</td>
                                                            <td></td>
                                                            <td>
                                                                <semantic-query
                                                                    query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                                                    ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                                                    template='{{#each bindings}}
                                                                        <span class="rs-badge rs-badge--white rs-body-s-M active" style="text-decoration:none;">0</span>
                                                                        {{/each}}'
                                                                    no-result-template='<span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>'>
                                                                </semantic-query>
                                                            </td>

                                                            <td>
                                                                <semantic-query
                                                                    query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                                                    ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                                                    template='{{#each bindings}}
                                                                        <span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>
                                                                        {{/each}}'
                                                                    no-result-template='<span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>'>
                                                                </semantic-query>
                                                            </td>

                                                            <!-- use followiong code for badge -->
                                                            <!-- 
                                        <semantic-query query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                        ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                        template='{{#each bindings}}
                                        <span class="rs-badge rs-badge--white rs-body-s-M active" style="text-decoration:none;">{{count.value}}</span>
                                        {{/each}}'
                                        no-result-template='<span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>'
                                        >
                                        </semantic-query>  -->

                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->
                                [[/if]]

                                [[#if (hasPermission "forms:ldp:*")]]
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Related Resources</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <!--  showall section -->

                                </div> <!--  close container -->
                                [[/if]]

                            </bs-tab-pane>
                            [[/if]]

                            <bs-tab-pane event-key="raw-data">
                                <div class="container-fluid rs-summary-section">
                                    <!-- <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            [[#block "instituteHeader"]]
                                            <span class="rs-h1 rs-section-header">Dataset</span>
                                            [[/block]]
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime
                                                format="dd-MM-yyyy"]].</span>
                                        </bs-col>
                                    </bs-row>  -->
                                    <!--  close row -->

                                    <!-- 1961 EDITION FIELDS -->
                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                  
                                            <h1>1961 Edition</h1> 
                                           
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <!-- 1938 EDITION FIELDS -->
                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">

                                            <h1>1938 Edition</h1>
                    

                                
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <!-- 1903 EDITION FIELDS -->
                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">

                                            <h1>1903 Edition</h1>
                       
                                
                                        </bs-col>
                                    </bs-row> <!--  close row -->


                                </div> <!--  close container -->

                            </bs-tab-pane>

                            [[#if withGeoData]]
                            <bs-tab-pane event-key="places" mount-on-enter=true style="padding-top: 0px;">
                                [[#block "geoData"]]
                                    <div></div>
                                [[/block]]
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="media" mount-on-enter=true>
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            <span class="rs-h1 rs-section-header">Images</span>
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>

                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            <span class="rs-h1 rs-section-header">Videos</span>
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>

                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            <span class="rs-h1 rs-section-header">3D Models</span>
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    [[!-- <bs-row class="row-center">
                                        <bs-col xs=11 class="rs-summary-table">
                                            <div class="rs-mirador-container">
                                                <rs-iiif-side-by-side
                                                    selection='[[jsonArrayFromSelect "SELECT DISTINCT ?value WHERE {  <[[this]]> crm:P138i_has_representation ?value } LIMIT 2" ]]'
                                                    [[> rsp:IIIFConfig]]/>
                                            </div>
                                        </bs-col>
                                    </bs-row> <!--  close row -->
                                    --]]

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="annotations">
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="position: relative; padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Annotations made</span>
                                            <span style="position: absolute; top: -1px; margin-left: 12px;">
                                                <button type="button"
                                                    class="rs-button rs-button-icon-S rs-button-icon-S--dark"
                                                    title="Add annotation">
                                                    <i class="rs-icon rs-icon-add"></i>
                                            </span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">

                                            [[!-- <div class="table-responsive rs-table">
                                                <semantic-table query="" number-of-displayed-rows=1
                                                    options='{"showFilter": true}' column-configuration='[
                                                                        {"displayName": "Field", "cellTemplate": "<semantic-link class=annotationWidth iri=\"{{o.value}}\">no data available</semantic-link>"},
                                                                        {"displayName": "Annotation Title" },
                                                                        {"displayName": "Author"},
                                                                        {"displayName": "Modified"},
                                                                        {"displayName": "Role"}
                                                                        ]'>
                                                </semantic-table>
                                            </div>
                                            --]]

                                            <div class="table-responsive rs-table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Field</th>
                                                            <th scope="col">Annotation Title</th>
                                                            <th scope="col">Author</th>
                                                            <th scope="col">Modified</th>
                                                            <th scope="col">Role</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>No data available</td>
                                                            <td></td>
                                                            <td></td>
                                                            <td></td>
                                                            <td></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="assertions">
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="position: relative; padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Assertions made</span>
                                            <span style="position: absolute; top: -1px; margin-left: 12px;">
                                                <button type="button"
                                                    class="rs-button rs-button-icon-S rs-button-icon-S--dark"
                                                    title="Add assertion">
                                                    <i class="rs-icon rs-icon-add"></i>
                                            </span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                                            <div class="table-responsive rs-table">
                                                [[!-- <semantic-table query="" number-of-displayed-rows=1
                                                    options='{"showFilter": true}' column-configuration='[
                                                                        {"displayName": "Field", "cellTemplate": "<semantic-link class=annotationWidth iri=\"{{o.value}}\">no data available</semantic-link>"},
                                                                        {"displayName": "Annotation Title" },
                                                                        {"displayName": "Author"},
                                                                        {"displayName": "Modified"},
                                                                        {"displayName": "Role"}
                                                                        ]'>
                                                </semantic-table> --]]
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="related">
                                <div class="container-fluid rs-summary-section">

                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="position: relative; padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Resources</span>
                                        </bs-col>
                                        <bs-col xs=3 md=3 lg=2>
                                            <input type="text" placeholder="Search in related data ..."
                                                class="rs-searchInput rs-body-s-M">
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=11 md=11 lg=10>
                                            [[#block "relatedResources"]]
                                            [[/block]]
                                        </bs-col>
                                    </bs-row> <!--  close row -->


                                    [[!-- <div class="rs-section-showall">
                                        <button type="button" class="rs-button rs-button-icon-M--dark">
                                            <i class="rs-icon rs-icon-chevron_down"></i>
                                        </button>
                                        <span class="rs-body-xs-I" style="margin-left:8px;">Show all fields</span>
                                    </div> --]]

                                </div> <!--  close container -->

                                <div class="container-fluid rs-summary-section rs-background-p10">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Pages</span>
                                        </bs-col>

                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                                            <div class="table-responsive rs-table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Modified</th>
                                                            <th scope="col">Page type</th>
                                                            <th scope="col">Link</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>12.12.2018</td>
                                                            <td>Narrative</td>
                                                            <td><a>page link</a></td>
                                                        </tr>
                                                        <tr>
                                                            <td>12.12.2018</td>
                                                            <td>Narrative</td>
                                                            <td><a>page link</a></td>
                                                        </tr>
                                                        <tr>
                                                            <td>12.12.2018</td>
                                                            <td>Narrative</td>
                                                            <td><a>page link</a></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <div class="rs-section-showall">
                                        <button type="button" class="rs-button rs-button-icon-M--dark">
                                            <i class="rs-icon rs-icon-chevron_down"></i>
                                        </button>
                                        <span class="rs-body-xs-I" style="margin-left:8px;">Show all fields</span>
                                    </div>

                                </div> <!--  close container -->

                                <div class="container-fluid rs-page-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Assertions</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row style="margin: 0;">
                                        <bs-col xs=12 class="rs-section-cards">
                                            [[#block "relatedAssertions"]]
                                            [[/block]]
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->

                                <div class="container-fluid rs-summary-section rs-background-p10">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Wikidata</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    [[#block "relatedWikidata"]]
                                    [[/block]]

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                        </bs-tab-content>
                    </div>
                </bs-tab-container>
            </div>
        </div>
    </template>
</with-types>
[[/if]]

[[#*inline "resourceHeaderData"]]
[[#block "headerData"]]
<!-- RESOURCE LABEL-->
<div class="rs-resource-header--singletitle">
    <div class="rs-display3 rs-resource-header--title" style="text-transform: capitalize;">
        <mp-label iri='[[this]]'></mp-label>
    </div>
</div>
<!-- DATA ON PAGE HEADER (right by the image) -->
<semantic-query query='SELECT  (<[[this]]> as ?iri)
                      (GROUP_CONCAT(DISTINCT(?id_number); SEPARATOR="") AS ?inventoryNumber)
                        (GROUP_CONCAT(DISTINCT(?id_number); SEPARATOR="") AS ?inventoryNumber)
                        (GROUP_CONCAT(DISTINCT(?technique); SEPARATOR=", ") AS ?techniqueList)
                           WHERE {
                            <[[this]]> crm:P108i_was_produced_by ?production.
                            ?production crm:P14_was_carried_out_by ?artist.
                            ?artist rdfs:label ?artist_name
                          
                            ## PREFERRED IDENTIFIER (Inventory Number) ##
                            OPTIONAL {
                                <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P48_has_preferred_identifier> ?id .
                                ?id rdfs:label ?id_number
                            }        

                            ## RECTO TITLE 1938 (Title) ##
                            OPTIONAL {
                              <[[this]]> crm:P56_bears_feature ?feature.
                              ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                              ?feature a crm:E25_Man-Made_Feature.
                              ?feature crm:P138_has_representation ?visual_item.
                              ?visual_item a crm:E36_Visual_Item.
                              ?visual_item crm:P102_has_title ?value_uri.
                              ?value_uri a crm:E35_Title.
                              ?value_uri rdfs:label ?recto_title_1938.
                              ?value_uri crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>
                            }
                      
                            ## RECTO TITLE 1961 (English Title) ##
                            OPTIONAL {
                              <[[this]]> crm:P56_bears_feature ?feature_b.
                              ?feature_b crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                              ?feature_b a crm:E25_Man-Made_Feature.
                              ?feature_b crm:P138_has_representation ?visual_item_b.
                              ?visual_item_b a crm:E36_Visual_Item.
                              ?visual_item_b crm:P102_has_title ?value_uri_b.
                              ?value_uri_b a crm:E35_Title.
                              ?value_uri_b rdfs:label ?recto_title_1961.
                              ?value_uri_b crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1961/attribute_assignment>
                            }

                            ## TECHNIQUE ##
                            <[[this]]> crm:P56_bears_feature ?feature.
                            ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                            ?feature a crm:E25_Man-Made_Feature.
                            ?feature crm:P81_was_modified_by ?modification.
                            ?modification a crm:E11_Modification.
                            ?modification crm:P32_used_general_technique ?general_technique.
                            ?general_technique rdfs:label ?technique
              
                        } GROUP BY ?iri' template='{{>headerDefaultData}}'>

    <template id="headerDefaultData">
        <div>
 
            
            {{#each bindings}}

                <div class="row rs-body-m-M" style="margin-bottom:16px;">
                    <!-- Inventory Number -->
                    <div class="[[#if image]]col-xs-4[[else]]col-xs-2[[/if]]">Inventory Number</div>
                    <div class="[[#if image]]col-xs-8[[else]]col-xs-10[[/if]]" style="text-transform:capitalize;">
                        {{inventoryNumber.value}} 
                    </div>
                </div>

                <!-- RESOURCE TYPE -->
                {{#ifCond techniqueList.value "!==" ""}}
                <div class="row rs-body-m-M" style="margin-bottom:16px;">
                    <div class="[[#if image]]col-xs-4[[else]]col-xs-2[[/if]]">Technique</div>
                    <div class="[[#if image]]col-xs-8[[else]]col-xs-10[[/if]]" style="text-transform:capitalize;">
                        {{techniqueList.value}}
                    </div>
            
                </div>
                {{/ifCond}}


    
            {{/each}}



        </div>
    </template>
</semantic-query>
  

[[/block]]
[[/inline]]
