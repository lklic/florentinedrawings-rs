[[#if (urlParam "details")]]
<div class="detail-sidebar-content">
    [[#block "detailsResourceHeader"]]
    <div style="display: flex; margin-bottom: 18px;">

        <mp-resource-thumbnail iri='[[this]]' class='detail-img'>
            <mp-resource-thumbnail-fallback>
                <with-types iri='[[this]]'
                        template='{{> noImage}}'
                        [[> rsp:TypeMappings]]     >
                    <template id="noImage">
                        <span class="rs-icon {{getValueByKey typeToImage allTypes 'rs-icon-no-image'}} detail-icon-noimg" alt="{{directTypesLabels}}" title='{{directTypesLabels}}'></span>
                    </template>
                </with-types>
            </mp-resource-thumbnail-fallback>
        </mp-resource-thumbnail>

        <div style="max-width: 70%;">
            
            <!-- <mp-draggable iri='[[this]]'> -->
                <div class="rs-draggable-container">
                    <semantic-query query='SELECT ?type ?typeLabel WHERE {
                                            <[[this]]> a ?type .
                                            ?type rdfs:label ?typeLabel .
                                            FILTER (lang(?typeLabel) = "en")}'
                        template='{{> resourceType }}'>
                        <template id='resourceType'>
                            <div class="detail-type">
                                {{#each bindings}}{{typeLabel.value}}{{#if @last}}{{else}}, {{/if}}{{/each}}
                            </div>
                        </template>
                    </semantic-query>
            
                    <mp-label iri='[[this]]' class="detail-label"></mp-label>
                </div>
            <!-- </mp-draggable> -->

            <mp-copy-to-clipboard text='[[this]]'>
                <div class="rs-copy-IRI">Copy resource IRI</div>
            </mp-copy-to-clipboard>
                
        </div>

    </div>
    [[/block]]
  
    <bs-tabs class="details-tabs">
    [[#if withSummary]]
        <bs-tab title='Summary' event-key='summary' mount-on-enter=true>
            <div class="rs-summary-table table-responsive rs-object-dataset--table">
                <table class="table table-hover">
                [[#block "summary"]]
                <tbody>
                    <tr>
                    <td>No further data available</td>
                    <td></td>
                    </tr>
                </tbody>
                [[/block]]
                </table>
            </div>
        </bs-tab>
    [[/if]]
        <bs-tab title='Raw data' event-key='raw-data' mount-on-enter=true class="rawdata-tab">
            <mp-field-visualization subject='[[this]]'
                fields='[[fieldDefinitionsFromQuery (setQueryBindings "SELECT DISTINCT ?field WHERE {?resource ?field ?o . ?field a <http://www.researchspace.org/resource/system/fields/Field> } ORDER BY DESC(?field)" resource=this.iri) ]]'
                template='{{> template}}'>
            <template id="template">{{> rsp:ResourceFieldBasedVisualization subject="[[this]]"}}</template>
            </mp-field-visualization>
        </bs-tab>
  </bs-tabs>
</div>

[[else]]
<with-types fixed-key='resource-[[this]]' iri='[[this]]'
        template='{{> resource}}'
        [[> rsp:TypeMappings]]
>
    <template id='resource'>
        <div style="width: 100%;">
            [[#block "resourceHeader"]]
            [[!-- Resource Header --]]
                <div class="container-fluid rs-resource-header {{getValueByKey entityBgColor allTypes 'rs-entity-bg-thing'}}">
                    [[!-- Header top with draggable link --]]
                    <bs-row class="row-center">
                        <bs-col xs=1 lg=2 class="px-0">
                        </bs-col>
                        <!-- <bs-col xs=10 lg=8 class="rs-resource-header-content">

                            <div class="rs-resource-header-content-underline">
                                [[!-- defaul Header top customisable inline --]]
                                [[#block "resourceHeaderTop"]]
                                <div class="row d-flex rs-vertical-align">
                                    <mp-popover class="rs-resource-header-popover">
                                        <mp-popover-trigger placement="right" trigger='["hover"]' root-close='true'>
                                            <div class="col-auto rs-h4 rs-resource-header-top">
                                                <mp-draggable iri='[[this]]'>
                                                    <div>
                                                        <i class="rs-icon {{getValueByKey typeToIcon allTypes 'rs-icon-entity'}}"></i>
                                                        <span style="margin-left: 8px;">{{directTypesLabels}} -&nbsp;</span>
                                                        <mp-label iri='[[this]]'></mp-label>
                                                    </div>
                                                </mp-draggable>
                                            </div>
                                        </mp-popover-trigger>
                                        
                                        <mp-popover-content>
                                            <div>Drag and drop in the Clipboard</div>
                                        </mp-popover-content>
                                    
                                    </mp-popover>
                                </div>
                                [[/block]]

                                <div class="rs-body-s-I">Author resource content</div>
                            </div>

                        </bs-col>
                     -->

                        <bs-col xs=1 lg=2 class="px-0" style="position: relative;">
                            <!-- <div class="rs-authoring-btnGroup">
                                <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                        urlqueryparam-view='knowledge-map' urlqueryparam-resource='[[this]]'>
                                    <button type="button" class="rs-authoring-btn" title="Author Resource in Knowledge Map">
                                        <i class="rs-icon rs-icon-diagram"></i>
                                    </button>
                                </semantic-link-container>
                                
                                <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                        urlqueryparam-view='entity-editor' urlqueryparam-resource='[[this]]'>
                                    <button type="button" class="rs-authoring-btn" title="Author Resource in Form">
                                        <i class="rs-icon rs-icon-form_edit"></i>
                                    </button>
                                </semantic-link-container>
                            </div> -->
                        </bs-col>
                    </bs-row> <!--  close row -->

                    [[!-- Header content with image (if available) and resource primary informations --]]
                    <div>
                        <bs-row class="row-center" style="padding:32px 0px 8px 0px;">
                            <bs-col xs=11 sm=10 lg=8 style="padding: 0px;">
                                <div class="row" style="height:100%;">
                                    <semantic-query template='{{> imageViewer}}' query='
                                    SELECT (count(?anyImage) as ?count) 
                                    WHERE { 
                                        <[[this]]> ?bears ?feat.             
                                        ?feat ?has ?img_visual.
                                        ?img_visual crm:P129i_is_subject_of ?anyImage.     
                                        ?anyImage crm:P2_has_type <http://iiif.io/api/image>.                                  
                                        FILTER (regex(str(?anyImage),".jpg"))                               
                                    }
                                    '>
                                    <template id='imageViewer'>

                                        {{#ifCond bindings.0.count.value "!==" "0"}}
                                            <div class="col-sm-12 col-md-6 rs-image-container" style="height: 45vh;">

                                            <!-- <div class="rs-resource-img__btngroup">

                                            <mp-overlay-dialog title="Resource Media" type="modal" class="modal-resourceMedia">
                                            <mp-overlay-dialog-trigger>
                                            <button type="button" class="rs-resource-img__btn" title="Explore Media">
                                            <i class="rs-icon rs-icon-expand_media"></i>
                                            </button>
                                            </mp-overlay-dialog-trigger>
                                            <mp-overlay-dialog-content>
                                            <mp-page-loader urlqueryparam-frame=true iri='http://www.researchspace.org/resource/ItemCardMedia' context='[[this]]'>
                                            </mp-page-loader>
                                            </mp-overlay-dialog-content>
                                            </mp-overlay-dialog>

                                            <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                            urlqueryparam-view='iiif' urlqueryparam-resource='[[this]]'>
                                            <button type="button" class="rs-resource-img__btn" title="Explore Images in high resolution Viewer">
                                            <i class="rs-icon rs-icon-image"></i>
                                            </button>
                                            </semantic-link-container>

                                            [[#if (hasPermission "forms:ldp:*")]]
                                            <semantic-link-container uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                            urlqueryparam-view='image-graph-authoring' urlqueryparam-resource='[[this]]'>
                                            <button type="button" class="rs-resource-img__btn" title="Annotate Images">
                                            <i class="rs-icon rs-icon-area_annotation"></i>
                                            </button>
                                            </semantic-link-container>
                                            [[/if]]

                                            </div>
                                            -->

                                            [[#block "imageContent"]]
  
                                            <!-- MAIN REPRESENTATION (bigger image) -->
                                            <semantic-if query='ASK { <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P56_bears_feature> ?main_feat.             
                                                ?main_feat <http://www.cidoc-crm.org/cidoc-crm/P138_has_representation> ?main_visual.
                                                ?main_visual crm:P129i_is_subject_of ?imgURL.   
                                             }'
                                                then='{{> then}}' else='{{> else}}'>
                                                <!-- Show recto or verso as main image if exists -->
                                                <template id="then">
                                                    <mp-overlay-dialog title="Inspect image in detail" class="miradorViewerPopup">
                                                        <mp-overlay-dialog-trigger>
                                                            <div class="rs-page__summary-image">
                                                                <semantic-query query='SELECT distinct ?imgURL ?label
                                                                WHERE {
                                                                    <[[this]]>  crm:P30_custody_transferred_through ?transfer.
                                                                    ?transfer crm:P29_custody_recieved_by ?location.
                                                                    ?location rdfs:label ?locationLabel.
                                                                    BIND(CONCAT("Image from ",?locationLabel) as ?label).             

                                                                    <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P56_bears_feature> ?main_feat.             
                                                                    ?main_feat <http://www.cidoc-crm.org/cidoc-crm/P138_has_representation> ?main_visual.
                                                                    ?main_visual crm:P129i_is_subject_of ?imgURL.   
                                                                    ?imgURL crm:P2_has_type <http://iiif.io/api/image>.
                                                                }' template='{{> imageThumbnail}}'>
                                                               <template id="imageThumbnail">
                                                                <img style="height:20vh" src="{{bindings.0.imgURL.value}}"/>
                                                                <div class="subtitle"><i>{{bindings.0.label.value}}</i></div>
                                                               </template>
                                                             </semantic-query>
                                                            </div>
                                                        </mp-overlay-dialog-trigger>
                                                        <mp-overlay-dialog-content>
                                                           <div style='height: 80vh; width: 100%;'>
                                                                <rs-iiif-mirador
                                                                image-or-region="[[this]]" 
                    
                                                                image-id-pattern='
                                                                BIND("image" AS ?type). BIND(?? AS ?imageIRI). 
                                                                <[[this]]> crm:P56_bears_feature ?feat.             
                                                                ?feat crm:P138_has_representation ?img_visual.
                                                                ?img_visual crm:P129i_is_subject_of ?image . 
                                                                BIND(REPLACE(STR(REPLACE(STR(?image),"/full/full/0/default.jpg","")), "(^.*)\\/(.*)$", "$2") AS ?imageID)
                                                                '
                                                                iiif-server-url="https://iiif.itatti.harvard.edu/iiif/2" 
                                                                >
                                                                </rs-iiif-mirador>
                                                            </div>
                                                        </mp-overlay-dialog-content>
                                                     </mp-overlay-dialog>
                                                </template>
                                                <!-- Else show the page or plate image as main image-->
                                                <template id="else">
                                                    <mp-overlay-dialog title="Inspect image in detail" class="miradorViewerPopup">
                                                        <mp-overlay-dialog-trigger>
                                                            <div class="rs-page__summary-image">
                                                                <semantic-query query='SELECT distinct ?pageplateImage
                                                                WHERE {
                                                                    <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P129i_is_subject_of> ?feat.             
                                                                    ?feat <http://www.cidoc-crm.org/cidoc-crm/P148_is_component_of> ?img_visual.
                                                                    ?img_visual crm:P129i_is_subject_of ?pageplateImage.  
                                                                    ?pageplateImage crm:P2_has_type <http://iiif.io/api/image>
                                                                    FILTER (regex(str(?pageplateImage),".jpg"))   
                                                                }' template='{{> imageThumbnail}}'>
                                                               <template id="imageThumbnail">
                                                                <img style="height:20vh" src="{{bindings.0.pageplateImage.value}}"/>
                                                                <div class="subtitle"><i>Page from the 1903 edition book</i></div>
                                                               </template>
                                                             </semantic-query>
                                                            </div>
                                                        </mp-overlay-dialog-trigger>
                                                        <mp-overlay-dialog-content>
                                                           <div style='height: 80vh; width: 100%;'>
                                                                <rs-iiif-mirador
                                                                image-or-region="[[this]]" 
                    
                                                                image-id-pattern='
                                                                BIND("image" AS ?type). BIND(?? AS ?imageIRI). 
                                                                <[[this]]> crm:P129i_is_subject_of ?feat.             
                                                                ?feat crm:P148_is_component_of ?img_visual.
                                                                ?img_visual crm:P129i_is_subject_of ?image . 
                                                                ?image crm:P2_has_type <http://iiif.io/api/image>.
                                                                BIND(REPLACE(STR(REPLACE(STR(?image),"/full/full/0/default.jpg","")), "(^.*)\\/(.*)$", "$2") AS ?imageID)
                                                                '
                                                                iiif-server-url="https://ids.lib.harvard.edu/ids/iiif" 
                                                                >
                                                                </rs-iiif-mirador>
                                                            </div>
                                                        </mp-overlay-dialog-content>
                                                     </mp-overlay-dialog>
                                                </template>
                                            </semantic-if>

                                            {{#ifCond bindings.0.count.value ">" "1"}}
                                              <!-- THUMBNAILS FOR RECTO & VERSO -->
                                              <mp-overlay-dialog title="Inspect image in detail" class="miradorViewerPopup">
                                                <mp-overlay-dialog-trigger>
                                                    <div >
                                                        <semantic-query query='SELECT DISTINCT ?imgUrl WHERE{
                                                            BIND(CONCAT("https://s3-eu-west-1.amazonaws.com/florentinedrawings/thumbs/",REPLACE(STR(REPLACE(STR(<[[this]]>),"/full/full/0/default.jpg","")), "(^.*)\\/(.*)$", "$2"),".jpg") AS ?imgUrl)
                                                          }' template='{{> imagesThumbnail}}'>
                                                       <template id="imagesThumbnail">
                                                           {{#each bindings}}
                                                            <img class="object-representations__image--rep" src="{{imgUrl.value}}"/>
                                                           {{/each}}
                                                       </template>
                                                     </semantic-query>
                                                    </div>
                                                </mp-overlay-dialog-trigger>
                                                <mp-overlay-dialog-content>
                                                   <div style='height: 80vh; width: 100%;'>
                                                        <rs-iiif-mirador
                                                        image-or-region="[[this]]" 
            
                                                        image-id-pattern='
                                                        BIND("image" AS ?type). BIND(?? AS ?imageIRI). 
                                                        <[[this]]> crm:P56_bears_feature ?feat.             
                                                        ?feat crm:P138_has_representation ?img_visual.
                                                        ?img_visual crm:P129i_is_subject_of ?image. 
                                                        BIND(REPLACE(STR(REPLACE(STR(?image),"/full/full/0/default.jpg","")), "(^.*)\\/(.*)$", "$2") AS ?imageID)
                                                        '
                                                        iiif-server-url="https://iiif.itatti.harvard.edu/iiif/2" 
                                                        >
                                                        </rs-iiif-mirador>
                                                    </div>
                                                </mp-overlay-dialog-content>
                                              </mp-overlay-dialog>
                                  
                                              <!-- THUMBNAILS FOR PAGES -->
                                              <mp-overlay-dialog title="Inspect image in detail" class="miradorViewerPopup">
                                                <mp-overlay-dialog-trigger>
                                                    <div >
                                                        <semantic-query query='SELECT  ?pageImage
                                                       WHERE {
                                                            OPTIONAL {
                                                                <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P129i_is_subject_of> ?feat.             
                                                                ?feat <http://www.cidoc-crm.org/cidoc-crm/P148_is_component_of> ?img_visual.
                                                                ?img_visual crm:P129i_is_subject_of ?pageImage.  
                                                                ?pageImage crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/type/500px>
                                                                FILTER (regex(str(?pageImage),".jpg"))   
                                                            }
                                                        }' template='{{> imagesThumbnail}}'>
                                                       <template id="imagesThumbnail">
                                                           {{#each bindings}}
                                                            <img class="object-representations__image--rep" src="{{pageImage.value}}"/>
                                                           {{/each}}
                                                       </template>
                                                     </semantic-query>
                                                    </div>
                                                </mp-overlay-dialog-trigger>
                                                <mp-overlay-dialog-content>
                                                   <div style='height: 80vh; width: 100%;'>
                                                        <rs-iiif-mirador
                                                        image-or-region="[[this]]" 
            
                                                        image-id-pattern='
                                                        BIND("image" AS ?type). BIND(?? AS ?imageIRI). 
                                                        <[[this]]> crm:P129i_is_subject_of ?feat.             
                                                        ?feat crm:P148_is_component_of ?img_visual.
                                                        ?img_visual crm:P129i_is_subject_of ?image . 
                                                        ?image crm:P2_has_type <http://iiif.io/api/image>.
                                                        BIND(REPLACE(STR(REPLACE(STR(?image),"/full/full/0/default.jpg","")), "(^.*)\\/(.*)$", "$2") AS ?imageID)
                                                        '
                                                        iiif-server-url="https://ids.lib.harvard.edu/ids/iiif" 
                                                        >
                                                        </rs-iiif-mirador>
                                                    </div>
                                                </mp-overlay-dialog-content>
                                              </mp-overlay-dialog>

                                            <!-- THUMBNAILS FOR PLATES -->
                                            <mp-overlay-dialog title="Inspect image in detail" class="miradorViewerPopup">
                                            <mp-overlay-dialog-trigger>
                                                <div >
                                                    <semantic-query query='SELECT  ?plateImage
                                                    WHERE {
                                                        OPTIONAL {
                                                            <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P56_bears_feature> ?feature.
                                                            ?feature <http://www.cidoc-crm.org/cidoc-crm/P129i_is_subject_of> ?plate.
                                                            ?plate crm:P129i_is_subject_of ?plateImage.  
                                                            ?plateImage crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/type/Thumbnail/200>
                                                            FILTER (regex(str(?plateImage),".jpg"))   
                                                        }
                                                    }' template='{{> imagesThumbnail}}'>
                                                    <template id="imagesThumbnail">
                                                        {{#each bindings}}
                                                        <img class="object-representations__image--rep" src="{{plateImage.value}}"/>
                                                        {{/each}}
                                                    </template>
                                                    </semantic-query>
                                                </div>
                                            </mp-overlay-dialog-trigger>
                                            <mp-overlay-dialog-content>
                                                <div style='height: 80vh; width: 100%;'>
                                                    <rs-iiif-mirador
                                                    image-or-region="[[this]]" 
        
                                                    image-id-pattern='
                                                    BIND("image" AS ?type). BIND(?? AS ?imageIRI). 
                                                    <[[this]]> crm:P56_bears_feature ?feat.             
                                                    ?feat crm:P129i_is_subject_of ?plate.
                                                    ?plate crm:P129i_is_subject_of ?image.  
                                                    ?image crm:P2_has_type <http://iiif.io/api/image>.
                                                    BIND(REPLACE(STR(REPLACE(STR(?image),"/full/full/0/default.jpg","")), "(^.*)\\/(.*)$", "$2") AS ?imageID)
                                                    '
                                                    iiif-server-url="https://ids.lib.harvard.edu/ids/iiif" 
                                                    >
                                                    </rs-iiif-mirador>
                                                </div>
                                            </mp-overlay-dialog-content>
                                            </mp-overlay-dialog>

                                              {{/ifCond}}
                                            [[/block]]
                                            </div>
                                            <div class="col-sm-12 col-md-6" style="padding: 1.8% 1.5% 1.5% 5%; height: fit-content;">
                                                [[> resourceHeaderData image=true]]
                                            </div>
                                            {{/ifCond}}

                                            {{#ifCond bindings.0.count.value "===" "0"}}
                                            <div class="col-xs-12 col-sm-6 rs-image-container" style="width:30vw; height: 45vh;">
                                                <img src='/assets/images/image_placeholder_large.png' style="width:100%"/>
                                            </div>
                                                <div class="col-xs-6 col-md-6" style="padding: 1.8% 1.5% 1.5% 5%; height: fit-content;">
                                                [[> resourceHeaderData image=true]]
                                            </div>
                                            {{/ifCond}}

                                    </template>
                          </semantic-query>
                                   
                                </div> <!--  close row -->
                            </bs-col>
                        </bs-row> <!--  close row -->
                    </div>
                </div>
            [[/block]]      

            [[!-- Tabs: Summary, raw data, Images, Annotation, Assertion, Related resources --]]
            <div class="container-fluid px-0">

                <bs-tab-container id="tab-container" class="rs-tabs"
                    default-active-key="[[#if withSummary]]summary[[else]]raw-data[[/if]]">
                    <div>
                        <bs-nav bs-style="tabs" class="{{getValueByKey entityBgColor allTypes 'rs-entity-bg-thing'}}">
                            [[#if withSummary]]
                            <bs-nav-item event-key="summary">Summary</bs-nav-item>
                            [[/if]]
                            <!-- <bs-nav-item event-key="raw-data">Raw data</bs-nav-item> -->
                            [[#if withGeoData]]
                            <bs-nav-item event-key="places">Related Places</bs-nav-item>
                            [[/if]]
                            
                            <!-- Disabled Several unused tabs -->

                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="media" disabled=true>Media</bs-nav-item>
                            [[/if]] -->
                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="annotations" disabled=true>Annotations
                                <span class="rs-badge rs-badge--info rs-body-s-M text-white"
                                    style="margin-left:8px;">0</span>
                                     <semantic-query query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                        ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                        template='{{#each bindings}}
                        <span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">{{count.value}}</span>
                        {{/each}}'
                        no-result-template='<span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">0</span>'
                        ></semantic-query>
                            </bs-nav-item>
                            [[/if]] -->
                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="assertions" disabled=true>Assertions
                                <span class="rs-badge rs-badge--info rs-body-s-M text-white"
                                    style="margin-left:8px;">0</span>
                                 <semantic-query query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                    ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                    template='{{#each bindings}}
                                    <span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">{{count.value}}</span>
                                    {{/each}}'
                                    no-result-template='<span class="rs-badge rs-badge--info rs-body-s-M text-white" style="margin-left:8px;">0</span>'
                                    ></semantic-query> 
                            </bs-nav-item>
                            [[/if]] -->
                            <!-- [[#if (hasPermission "forms:ldp:*")]]
                            <bs-nav-item event-key="related" disabled=true>Explore Related</bs-nav-item>
                            [[/if]] -->
                        </bs-nav>

                        <bs-tab-content animation="true">
                            [[#if withSummary]]
                            <bs-tab-pane event-key="summary">
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            [[#block "instituteHeader"]]
                                            <span class="rs-h1 rs-section-header">Dataset</span>
                                            [[/block]]

                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">

                                            <div class="table-responsive rs-table rs-object-dataset--table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col" style="width: 30%">Field</th>
                                                            <th scope="col">Value</th>
                                                        </tr>
                                                    </thead>
                                                    [[#block "summary"]]
                                                    <tbody>
                                                        <tr>
                                                            <td>No further data available</td>
                                                            <td></td>
                                                        </tr>
                                                    </tbody>
                                                    [[/block]]
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->
                                </div> <!--  close container -->

                                [[#if (hasPermission "forms:ldp:*")]]
                                <div class="container-fluid rs-summary-section rs-background-p10">
                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Public Discussion</span>
                                            <span class="rs-body-xs-I rs-section-header">Documents the ongoing discussion
                                                about findings.
                                                <a style="padding-left:5px; text-decoration: underline;">Read more</a>
                                            </span>
                                        </bs-col>
                                        <bs-col xs=3 md=3 lg=2>
                                            <input type="text" placeholder="Assert new value..."
                                                class="rs-searchInput rs-body-s-M">
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                                            <div class="table-responsive rs-table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Field</th>
                                                            <th scope="col">Value</th>
                                                            <th scope="col">Annotation</th>
                                                            <th scope="col">Assertion</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>No data available</td>
                                                            <td></td>
                                                            <td>
                                                                <semantic-query
                                                                    query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                                                    ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                                                    template='{{#each bindings}}
                                                                        <span class="rs-badge rs-badge--white rs-body-s-M active" style="text-decoration:none;">0</span>
                                                                        {{/each}}'
                                                                    no-result-template='<span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>'>
                                                                </semantic-query>
                                                            </td>

                                                            <td>
                                                                <semantic-query
                                                                    query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                                                    ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                                                    template='{{#each bindings}}
                                                                        <span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>
                                                                        {{/each}}'
                                                                    no-result-template='<span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>'>
                                                                </semantic-query>
                                                            </td>

                                                            <!-- use followiong code for badge -->
                                                            <!-- 
                                        <semantic-query query="SELECT (COUNT(DISTINCT ?s) AS ?count) WHERE {
                                        ?s <http://www.ics.forth.gr/isl/CRMdig/L43_annotates> <[[this]]>;}"
                                        template='{{#each bindings}}
                                        <span class="rs-badge rs-badge--white rs-body-s-M active" style="text-decoration:none;">{{count.value}}</span>
                                        {{/each}}'
                                        no-result-template='<span class="rs-badge rs-badge--white rs-body-s-M" style="text-decoration:none;">0</span>'
                                        >
                                        </semantic-query>  -->

                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->
                                [[/if]]

                                [[#if (hasPermission "forms:ldp:*")]]
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Related Resources</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <!--  showall section -->

                                </div> <!--  close container -->
                                [[/if]]

                            </bs-tab-pane>
                            [[/if]]

                            <bs-tab-pane event-key="raw-data">
                                <div class="container-fluid rs-summary-section">
                                    <!--  close row -->
                                    <semantic-table query=' SELECT DISTINCT
                                    ?id_number ?location  ?catalogue_number ?plate_number
                                    ?recto_title_1903 ?verso_title_1903 ?recto_notes_1903 ?verso_notes_1903
                                    ?recto_title_1938 ?verso_title_1938 ?recto_notes_1938 ?verso_notes_1938
                                    ?recto_title_1961 ?verso_title_1961 ?recto_notes_1961 ?verso_notes_1961
                                    WHERE {
                      
                                    ## LOCATION ##
                                    OPTIONAL {
                                        <[[this]]>  crm:P30_custody_transferred_through ?transfer.
                                         ?transfer crm:P29_custody_recieved_by ?location.
                                    }
                                      
                                     ## PREFERRED IDENTIFIER (Inventory Number) ##
                                     OPTIONAL {
                                         <[[this]]> <http://www.cidoc-crm.org/cidoc-crm/P48_has_preferred_identifier> ?id .
                                         ?id rdfs:label ?id_number
                                     }        

                                     OPTIONAL{
                                        <[[this]]> crm:P56_bears_feature ?plate_feat.             
                                        ?plate_feat crm:P129i_is_subject_of ?plate.
                                        ?plate crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/type/Plate>.
                                        ?plate rdfs:label ?plate_number
                                     }
                                    
                                     ## RECTO TITLE 1903 (Title) ##
                                     OPTIONAL {
                                       <[[this]]> crm:P56_bears_feature ?feature_rta.
                                       ?feature_rta crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                       ?feature_rta a crm:E25_Man-Made_Feature.
                                       ?feature_rta crm:P138_has_representation ?visual_item_rta.
                                       ?visual_item_rta a crm:E36_Visual_Item.
                                       ?visual_item_rta crm:P102_has_title ?value_uri_rta.
                                       ?value_uri_rta a crm:E35_Title.
                                       ?value_uri_rta rdfs:label ?recto_title_1903.
                                       ?value_uri_rta crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1903/attribute_assignment>
                                     }
                                    
                                     ## VERSO TITLE 1903 (English Title) ##
                                     OPTIONAL {
                                        <[[this]]> crm:P56_bears_feature ?feature_vta.
                                        ?feature_vta crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
                                        ?feature_vta crm:P138_has_representation ?visual_item_vta.
                                        ?visual_item_vta a crm:E36_Visual_Item.
                                        ?visual_item_vta crm:P102_has_title ?value_uri_vta.
                                        ?value_uri_vta a crm:E35_Title.
                                        ?value_uri_vta rdfs:label ?verso_title_1903.
                                        ?value_uri_vta crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1903/attribute_assignment>.
                                      }

                                    ## VERSO NOTES 1903 ##
                                    OPTIONAL{
                                        <[[this]]> crm:P56_bears_feature ?feature_vna.
                                        ?feature_vna crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
                                        ?feature_vna crm:P138_has_representation ?visual_item_vna.
                                        ?visual_item_vna a crm:E36_Visual_Item.
                                        ?visual_item_vna crm:P67i_is_referred_to_by ?object_vna.
                                        ?object_vna a crm:E33_Linguistic_Object.
                                        ?object_vna rdfs:label ?verso_notes_1903.
                                        ?object_vna crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1903/attribute_assignment>.
                                    }

                                    ## RECTO NOTES 1903 ##
                                    OPTIONAL{
                                        <[[this]]> crm:P56_bears_feature ?feature_rna.
                                        ?feature_rna crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                        ?feature_rna crm:P138_has_representation ?visual_item_rna.
                                        ?visual_item_rna a crm:E36_Visual_Item.
                                        ?visual_item_rna crm:P67i_is_referred_to_by ?object_rna.
                                        ?object_rna a crm:E33_Linguistic_Object.
                                        ?object_rna rdfs:label ?recto_notes_1903.
                                        ?object_rna crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1903/attribute_assignment>.
                                    }

                                     ## RECTO TITLE 1938 (Title) ##
                                     OPTIONAL {
                                       <[[this]]> crm:P56_bears_feature ?feature.
                                       ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                       ?feature a crm:E25_Man-Made_Feature.
                                       ?feature crm:P138_has_representation ?visual_item.
                                       ?visual_item a crm:E36_Visual_Item.
                                       ?visual_item crm:P102_has_title ?value_uri.
                                       ?value_uri a crm:E35_Title.
                                       ?value_uri rdfs:label ?recto_title_1938.
                                       ?value_uri crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>
                                     }
                                    
                                     ## VERSO TITLE 1938 (English Title) ##
                                     OPTIONAL {
                                        <[[this]]> crm:P56_bears_feature ?feature_vb.
                                        ?feature_vb crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
                                        ?feature_vb crm:P138_has_representation ?visual_item_vb.
                                        ?visual_item_vb a crm:E36_Visual_Item.
                                        ?visual_item_vb crm:P102_has_title ?value_uri_vb.
                                        ?value_uri_vb a crm:E35_Title.
                                        ?value_uri_vb rdfs:label ?verso_title_1938.
                                        ?value_uri_vb crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>.
                                      }

                                    ## VERSO NOTES 1938 ##
                                    OPTIONAL{
                                        <[[this]]> crm:P56_bears_feature ?feature_vnb.
                                        ?feature_vnb crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
                                        ?feature_vnb crm:P138_has_representation ?visual_item_vnb.
                                        ?visual_item_vnb a crm:E36_Visual_Item.
                                        ?visual_item_vnb crm:P67i_is_referred_to_by ?object_vnb.
                                        ?object_vnb a crm:E33_Linguistic_Object.
                                        ?object_vnb rdfs:label ?verso_notes_1938.
                                        ?object_vnb crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>.
                                    }

                                    ## RECTO NOTES 1938 ##
                                    OPTIONAL{
                                        <[[this]]> crm:P56_bears_feature ?feature_rnb.
                                        ?feature_rnb crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                        ?feature_rnb crm:P138_has_representation ?visual_item_rnb.
                                        ?visual_item_rnb a crm:E36_Visual_Item.
                                        ?visual_item_rnb crm:P67i_is_referred_to_by ?object_rnb.
                                        ?object_rnb a crm:E33_Linguistic_Object.
                                        ?object_rnb rdfs:label ?recto_notes_1938.
                                        ?object_rnb crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>.
                                    }

                                     ## RECTO TITLE 1961 (English Title) ##
                                     OPTIONAL {
                                       <[[this]]> crm:P56_bears_feature ?feature_b.
                                       ?feature_b crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                       ?feature_b a crm:E25_Man-Made_Feature.
                                       ?feature_b crm:P138_has_representation ?visual_item_b.
                                       ?visual_item_b a crm:E36_Visual_Item.
                                       ?visual_item_b crm:P102_has_title ?value_uri_b.
                                       ?value_uri_b a crm:E35_Title.
                                       ?value_uri_b rdfs:label ?recto_title_1961.
                                       ?value_uri_b crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1961/attribute_assignment>
                                     }
                                     
                                     ## VERSO TITLE 1961 (English Title) ##
                                     OPTIONAL {
                                        <[[this]]> crm:P56_bears_feature ?feature_va.
                                        ?feature_va crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
                                        ?feature_va crm:P138_has_representation ?visual_item_va.
                                        ?visual_item_va a crm:E36_Visual_Item.
                                        ?visual_item_va crm:P102_has_title ?value_uri_va.
                                        ?value_uri_va a crm:E35_Title.
                                        ?value_uri_va rdfs:label ?verso_title_1961.
                                        ?value_uri_va crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1961/attribute_assignment>.
                                      }

                                      ## RECTO NOTES 1961 ##
                                      OPTIONAL{
                                       <[[this]]> crm:P56_bears_feature ?feature_rnc.
                                          ?feature_rnc crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                          ?feature_rnc crm:P138_has_representation ?visual_item_rnc.
                                          ?visual_item_rnc a crm:E36_Visual_Item.
                                          ?visual_item_rnc crm:P67i_is_referred_to_by ?object_rnc.
                                          ?object_rnc a crm:E33_Linguistic_Object.
                                          ?object_rnc rdfs:label ?recto_notes_1961.
                                          ?object_rnc crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1961/attribute_assignment>.
                                      }
                                    }' options='{"showFilter":false}' tuple-template='{{>editionRows}}'>
                                    
                                        <template id="editionRows">
                                            <bs-row class="row-center">
                                                <bs-col xs=11 sm=10 md=8 lg=7 class="rs-summary-table">
                                             <!-- 1961 EDITION FIELDS -->
                                                    <h1 style=" text-align: center;">1961 Edition</h1> 
                                                    <div  id="1961_edition_result">
                                                        <bs-col>
                                                            <div data-flex-layout="row md-column center-stretch">
                                                              <bs-row>
                                                                <div>
                                                                    {{#ifCond recto_title_1961.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Recto Title (1961): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{recto_title_1961.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond verso_title_1961.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Verso Title (1961): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{verso_title_1961.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond plate_number.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Plate number: </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{plate_number.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?pageNumber WHERE {
                                                                        <[[this]]> crm:P129i_is_subject_of ?edition.
                                                                        ?edition a crm:E73_Information_Object.
                                                                        ?edition crm:P148_is_component_of ?page.
                                                                        ?page crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/work/type/Page> .
                                                                        ?page rdfs:label ?pageNumber
                                                                        FILTER(regex(str(?edition),"/1961"))   
                                                                      }
                                                                ' 
                                                                template="{{> pageNumberTemplate1961}}"
                                                                > 
                                                                <template id="pageNumberTemplate1961">
                                                                       {{#ifCond bindings.0.pageNumber.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Page number:</b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{#each bindings}}
                                                                                {{pageNumber.value}}  
                                                                            {{/each}}
                                                                        </div>
                                                                        </bs-col>
                                                                    {{/ifCond}}
                                                                </template>
                                                                    </semantic-query>
             
                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?catalogueNumber WHERE {
                                                                        <[[this]]> crm:P1_is_identified_by ?cat_no.
                                                                        ?cat_no a crm:E42_Identifier.
                                                                        ?cat_no crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/type/Berenson%20Catalogue%20Number>.
                                                                        ?cat_no rdfs:label ?catalogueNumber.
                                                                        FILTER(regex(str(?cat_no),"/1961"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> catalogueNumberTemplate1961}}"
                                                                    > 
                                                                        <template id="catalogueNumberTemplate1961">
                                                                            {{#ifCond bindings.0.catalogueNumber.value "!==" undefined}}
                                                                            <bs-col md="4">
                                                                                <div class="grid-demo">
                                                                                    <b>Berenson Cat. No.:</b>
                                                                                </div>
                                                                            </bs-col>
                                                                            <bs-col md="8">
                                                                                <div class="grid-demo">
                                                                                    {{#each bindings}}
                                                                                        {{catalogueNumber.value}}                                                             
                                                                                    {{/each}}
                                                                                </div>
                                                                                </bs-col>
                                                                            {{/ifCond}}
                                                                        </template>
                                                                    </semantic-query>

                                                                    <semantic-query query='
                                                                        SELECT DISTINCT ?artist_1961 ?label WHERE {
                                                                            <[[this]]> crm:P108i_was_produced_by ?production.
                                                                            ?production crm:P01i_is_domain_of ?domain.
                                                                            ?domain crm:P02_has_range ?artist_1961.
                                                                            ?artist_1961 rdfs:label ?artistLabel.
                                                                             {
                                                                                ?domain a crm:PC15_was_influenced_by.
                                                                                ?domain crm:P15.1_in_the_role_of ?qualifier.
                                                                                ?qualifier rdfs:label ?qualifierLabel.
                                                                             } union {
                                                                                FILTER NOT EXISTS{ ?domain a crm:PC15_was_influenced_by.}
                                                                                BIND("by" as ?qualifierLabel)
                                                                              } 
                                                                            BIND(CONCAT(?artistLabel," (",?qualifierLabel,")") as ?label)
                                                                             FILTER(regex(str(?domain),"/1961"))   
                                                                          }
                                                                    ' 
                                                                    template="{{> qualifierTemplate1961}}"
                                                                    > 
                                                                    <template id="qualifierTemplate1961">
                                                                        {{log bindings}}
                                                                        {{#each bindings}}
                                                                           {{#ifCond artist_1961.value "!==" undefined}}
                                                                        <bs-col md="4">
                                                                            <div class="grid-demo">
                                                                                <b>Artist Attribution: </b>
                                                                            </div>
                                                                        </bs-col>
                                                                        <bs-col md="8">
                                                                            <div class="grid-demo">
                                                                                <semantic-link iri={{artist_1961.value}}>{{label.value}}</semantic-link>                                                                     
                                                                            </div>
                                                                            </bs-col>
                                                                        {{/ifCond}}
                                                                        {{/each}}
                                                                    </template>
                                                                    </semantic-query>

                                                                    {{#ifCond recto_notes_1961.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Recto Notes (1961): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{recto_notes_1961.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}             
                                
                                                                </div>
                                                              </bs-row>
                                                            </div>
                                                          </bs-col>
                                                    </div>
                                                </bs-col>
                                            </bs-row> <!--  close row -->
        
                                            <!-- 1938 EDITION FIELDS -->
                                            <bs-row class="row-center">
                                                <bs-col xs=11 sm=10 md=8 lg=7 class="rs-summary-table">
        
                                                    <h1 style=" text-align: center;">1938 Edition</h1>
                                                    <div id="1938_edition_result">
                                                        <bs-col>
                                                            <div data-flex-layout="row md-column center-stretch">
                                                              <bs-row>
                                                                <div>
                                                                                    
                                                                    {{#ifCond recto_title_1938.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Recto Title (1938): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{recto_title_1938.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond verso_title_1938.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Verso Title (1938): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{verso_title_1938.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond plate_number.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Plate number: </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{plate_number.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}
                                                                    
                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?catalogueNumber WHERE {
                                                                        <[[this]]> crm:P1_is_identified_by ?cat_no.
                                                                        ?cat_no a crm:E42_Identifier.
                                                                        ?cat_no crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/type/Berenson%20Catalogue%20Number>.
                                                                        ?cat_no rdfs:label ?catalogueNumber.
                                                                        FILTER(regex(str(?cat_no),"/1938"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> catalogueNumberTemplate1938}}"
                                                                    > 
                                                                        <template id="catalogueNumberTemplate1938">
                                                                            {{#ifCond bindings.0.catalogueNumber.value "!==" undefined}}
                                                                            <bs-col md="4">
                                                                                <div class="grid-demo">
                                                                                    <b>Berenson Cat. No.:</b>
                                                                                </div>
                                                                            </bs-col>
                                                                            <bs-col md="8">
                                                                                <div class="grid-demo">
                                                                                    {{#each bindings}}
                                                                                        {{catalogueNumber.value}}                                                             
                                                                                    {{/each}}
                                                                                </div>
                                                                                </bs-col>
                                                                            {{/ifCond}}
                                                                        </template>
                                                                    </semantic-query>

                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?pageNumber WHERE {
                                                                        <[[this]]> crm:P129i_is_subject_of ?edition.
                                                                        ?edition a crm:E73_Information_Object.
                                                                        ?edition crm:P148_is_component_of ?page.
                                                                        ?page crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/work/type/Page> .
                                                                        ?page rdfs:label ?pageNumber
                                                                        FILTER(regex(str(?edition),"/1938"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> pageNumberTemplate1938}}"
                                                                    > 
                                                                        <template id="pageNumberTemplate1938">
                                                                            {{#ifCond bindings.0.pageNumber.value "!==" undefined}}
                                                                            <bs-col md="4">
                                                                                <div class="grid-demo">
                                                                                    <b>Page number:</b>
                                                                                </div>
                                                                            </bs-col>
                                                                            <bs-col md="8">
                                                                                <div class="grid-demo">
                                                                                    {{#each bindings}}
                                                                                        {{pageNumber.value}}                                                             
                                                                                    {{/each}}
                                                                                </div>
                                                                                </bs-col>
                                                                            {{/ifCond}}
                                                                        </template>
                                                                    </semantic-query>

                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?artist_1938 ?label WHERE {
                                                                        <[[this]]> crm:P108i_was_produced_by ?production.
                                                                        ?production crm:P01i_is_domain_of ?domain.
                                                                        ?domain crm:P02_has_range ?artist_1938.
                                                                        ?artist_1938 rdfs:label ?artistLabel.
                                                                         {
                                                                            ?domain a crm:PC15_was_influenced_by.
                                                                            ?domain crm:P15.1_in_the_role_of ?qualifier.
                                                                            ?qualifier rdfs:label ?qualifierLabel.
                                                                         } union {
                                                                            FILTER NOT EXISTS{ ?domain a crm:PC15_was_influenced_by.}
                                                                            BIND("by" as ?qualifierLabel)
                                                                          } 
                                                                        BIND(CONCAT(?artistLabel," (",?qualifierLabel,")") as ?label)
                                                                         FILTER(regex(str(?domain),"/1938"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> qualifierTemplate1938}}"
                                                                    > 
                                                                    <template id="qualifierTemplate1938">
                                                                        {{#each bindings}}
                                                                           {{#ifCond artist_1938.value "!==" undefined}}
                                                                        <bs-col md="4">
                                                                            <div class="grid-demo">
                                                                                <b>Artist Attribution: </b>
                                                                            </div>
                                                                        </bs-col>
                                                                        <bs-col md="8">
                                                                            <div class="grid-demo">
                                                                                <semantic-link iri={{artist_1938.value}}>{{label.value}}</semantic-link>
                                                                            </div>
                                                                            </bs-col>
                                                                        {{/ifCond}}
                                                                        {{/each}}
                                                                    </template>
                                                                    </semantic-query>

                                                                    {{#ifCond recto_notes_1938.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Recto Notes (1938): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{recto_notes_1938.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond verso_notes_1938.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Verso Notes (1938): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{verso_notes_1938.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}
                                                            
                                                                </div>
                                                              </bs-row>
                                                            </div>
                                                          </bs-col>
                                                    </div>
                                                </bs-col>
                                            </bs-row> <!--  close row -->
        
                                            <!-- 1903 EDITION FIELDS -->
                                            <bs-row class="row-center">
                                                <bs-col xs=11 sm=10 md=8 lg=7 class="rs-summary-table">
                                                    
                                                    <h1 style=" text-align: center;">1903 Edition</h1>
                                                        <div id="1903_edition_result">
                                                        <bs-col>
                                                            <div data-flex-layout="row md-column center-stretch">
                                                              <bs-row>
                                                                <div>
                                                                                    
                                                                    {{#ifCond recto_title_1903.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Recto Title (1903): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{recto_title_1903.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond verso_title_1903.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Verso Title (1903): </b>

                                                                        </div>
                                                                        </bs-col>
                                                                    <bs-col md="6">
                                                                            <div class="grid-demo">
                                                                                {{verso_title_1903.value}}
                                                                            </div>
                                                                        </bs-col>
                                                                    {{/ifCond}}

                                                                    {{#ifCond plate_number.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Plate number: </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{plate_number.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}

                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?catalogueNumber WHERE {
                                                                        <[[this]]> crm:P1_is_identified_by ?cat_no.
                                                                        ?cat_no a crm:E42_Identifier.
                                                                        ?cat_no crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/type/Berenson%20Catalogue%20Number>.
                                                                        ?cat_no rdfs:label ?catalogueNumber.
                                                                        FILTER(regex(str(?cat_no),"/1903"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> catalogueNumberTemplate1903}}"
                                                                    > 
                                                                        <template id="catalogueNumberTemplate1903">
                                                                            {{#ifCond bindings.0.catalogueNumber.value "!==" undefined}}
                                                                            <bs-col md="4">
                                                                                <div class="grid-demo">
                                                                                    <b>Berenson Cat. No.:</b>
                                                                                </div>
                                                                            </bs-col>
                                                                            <bs-col md="8">
                                                                                <div class="grid-demo">
                                                                                    {{#each bindings}}
                                                                                        {{catalogueNumber.value}}                                                             
                                                                                    {{/each}}
                                                                                </div>
                                                                                </bs-col>
                                                                            {{/ifCond}}
                                                                        </template>
                                                                    </semantic-query>
                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?pageNumber WHERE {
                                                                        <[[this]]> crm:P129i_is_subject_of ?edition.
                                                                        ?edition a crm:E73_Information_Object.
                                                                        ?edition crm:P148_is_component_of ?page.
                                                                        ?page crm:P2_has_type <https://florentinedrawings.itatti.harvard.edu/resource/work/type/Page> .
                                                                        ?page rdfs:label ?pageNumber
                                                                        FILTER(regex(str(?edition),"/1903"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> pageNumberTemplate1903}}"
                                                                    > 
                                                                        <template id="pageNumberTemplate1903">
                                                                            {{#ifCond bindings.0.pageNumber.value "!==" undefined}}
                                                                            <bs-col md="4">
                                                                                <div class="grid-demo">
                                                                                    <b>Page number:</b>
                                                                                </div>
                                                                            </bs-col>
                                                                            <bs-col md="8">
                                                                                <div class="grid-demo">
                                                                            {{#each bindings}}
                                                                                    {{pageNumber.value}}                                                             
                                                                                    {{/each}}
                                                                                </div>
                                                                                </bs-col>
                                                                            {{/ifCond}}
                                                                        </template>
                                                                    </semantic-query>

                                                                    <semantic-query query='
                                                                    SELECT DISTINCT ?artist_1903 ?label WHERE {
                                                                        <[[this]]> crm:P108i_was_produced_by ?production.
                                                                        ?production crm:P01i_is_domain_of ?domain.
                                                                        ?domain crm:P02_has_range ?artist_1903.
                                                                        ?artist_1903 rdfs:label ?artistLabel.
                                                                         {
                                                                            ?domain a crm:PC15_was_influenced_by.
                                                                            ?domain crm:P15.1_in_the_role_of ?qualifier.
                                                                            ?qualifier rdfs:label ?qualifierLabel.
                                                                         } union {
                                                                            FILTER NOT EXISTS{ ?domain a crm:PC15_was_influenced_by.}
                                                                            BIND("by" as ?qualifierLabel)
                                                                          } 
                                                                        BIND(CONCAT(?artistLabel," (",?qualifierLabel,")") as ?label)
                                                                         FILTER(regex(str(?domain),"/1903"))   
                                                                      }
                                                                    ' 
                                                                    template="{{> qualifierTemplate1903}}"
                                                                    > 
                                                                    <template id="qualifierTemplate1903">
                                                                        {{#each bindings}}
                                                                           {{#ifCond artist_1903.value "!==" undefined}}
                                                                        <bs-col md="4">
                                                                            <div class="grid-demo">
                                                                                <b>Artist Attribution: </b>
                                                                            </div>
                                                                        </bs-col>
                                                                        <bs-col md="8">
                                                                            <div class="grid-demo">
                                                                                <semantic-link iri={{artist_1903.value}}>{{label.value}}</semantic-link>      
                                                                            </div>
                                                                            </bs-col>
                                                                        {{/ifCond}}
                                                                        {{/each}}
                                                                    </template>
                                                                    </semantic-query>

                                                                    {{#ifCond recto_notes_1903.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                        <b>Recto Notes (1903): </b>
                                                                    </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{recto_notes_1903.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}
                                                                    
                                                                    {{#ifCond verso_notes_1903.value "!==" undefined}}
                                                                    <bs-col md="4">
                                                                        <div class="grid-demo">
                                                                            <b>Verso Notes (1903): </b>
                                                                        </div>
                                                                    </bs-col>
                                                                    <bs-col md="8">
                                                                        <div class="grid-demo">
                                                                            {{verso_notes_1903.value}}
                                                                        </div>
                                                                    </bs-col>
                                                                    {{/ifCond}}
                                                                                        
                                                            
                                                                </div>
                                                              </bs-row>
                                                            </div>
                                                          </bs-col>
                                            
                                            
                                                    </div>
        
                                        
                                                </bs-col>
                                            </bs-row> <!--  close row -->

                                        </template>
                                    </semantic-table>
                                </div> <!--  close container -->

                            </bs-tab-pane>

                            [[#if withGeoData]]
                            <bs-tab-pane event-key="places" mount-on-enter=true style="padding-top: 0px;">
                                [[#block "geoData"]]
                                    <div></div>
                                [[/block]]
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="media" mount-on-enter=true>
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            <span class="rs-h1 rs-section-header">Images</span>
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>

                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            <span class="rs-h1 rs-section-header">Videos</span>
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>

                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">

                                            <span class="rs-h1 rs-section-header">3D Models</span>
                                            <span class="rs-body-xs-I rs-section-header">Latest confirmed data set from
                                                [[currentDateTime format="dd-MM-yyyy"]].</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    [[!-- <bs-row class="row-center">
                                        <bs-col xs=11 class="rs-summary-table">
                                            <div class="rs-mirador-container">
                                                <rs-iiif-side-by-side
                                                    selection='[[jsonArrayFromSelect "SELECT DISTINCT ?value WHERE {  <[[this]]> crm:P138i_has_representation ?value } LIMIT 2" ]]'
                                                    [[> rsp:IIIFConfig]]/>
                                            </div>
                                        </bs-col>
                                    </bs-row> <!--  close row -->
                                    --]]

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="annotations">
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="position: relative; padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Annotations made</span>
                                            <span style="position: absolute; top: -1px; margin-left: 12px;">
                                                <button type="button"
                                                    class="rs-button rs-button-icon-S rs-button-icon-S--dark"
                                                    title="Add annotation">
                                                    <i class="rs-icon rs-icon-add"></i>
                                            </span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">

                                            [[!-- <div class="table-responsive rs-table">
                                                <semantic-table query="" number-of-displayed-rows=1
                                                    options='{"showFilter": true}' column-configuration='[
                                                                        {"displayName": "Field", "cellTemplate": "<semantic-link class=annotationWidth iri=\"{{o.value}}\">no data available</semantic-link>"},
                                                                        {"displayName": "Annotation Title" },
                                                                        {"displayName": "Author"},
                                                                        {"displayName": "Modified"},
                                                                        {"displayName": "Role"}
                                                                        ]'>
                                                </semantic-table>
                                            </div>
                                            --]]

                                            <div class="table-responsive rs-table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Field</th>
                                                            <th scope="col">Annotation Title</th>
                                                            <th scope="col">Author</th>
                                                            <th scope="col">Modified</th>
                                                            <th scope="col">Role</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>No data available</td>
                                                            <td></td>
                                                            <td></td>
                                                            <td></td>
                                                            <td></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="assertions">
                                <div class="container-fluid rs-summary-section">
                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="position: relative; padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Assertions made</span>
                                            <span style="position: absolute; top: -1px; margin-left: 12px;">
                                                <button type="button"
                                                    class="rs-button rs-button-icon-S rs-button-icon-S--dark"
                                                    title="Add assertion">
                                                    <i class="rs-icon rs-icon-add"></i>
                                            </span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                                            <div class="table-responsive rs-table">
                                                [[!-- <semantic-table query="" number-of-displayed-rows=1
                                                    options='{"showFilter": true}' column-configuration='[
                                                                        {"displayName": "Field", "cellTemplate": "<semantic-link class=annotationWidth iri=\"{{o.value}}\">no data available</semantic-link>"},
                                                                        {"displayName": "Annotation Title" },
                                                                        {"displayName": "Author"},
                                                                        {"displayName": "Modified"},
                                                                        {"displayName": "Role"}
                                                                        ]'>
                                                </semantic-table> --]]
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                            [[#if (hasPermission "forms:ldp:*")]]
                            <bs-tab-pane event-key="related">
                                <div class="container-fluid rs-summary-section">

                                    <bs-row>
                                        <bs-col xs=9 md=7 lg=8 style="position: relative; padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Resources</span>
                                        </bs-col>
                                        <bs-col xs=3 md=3 lg=2>
                                            <input type="text" placeholder="Search in related data ..."
                                                class="rs-searchInput rs-body-s-M">
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=11 md=11 lg=10>
                                            [[#block "relatedResources"]]
                                            [[/block]]
                                        </bs-col>
                                    </bs-row> <!--  close row -->


                                    [[!-- <div class="rs-section-showall">
                                        <button type="button" class="rs-button rs-button-icon-M--dark">
                                            <i class="rs-icon rs-icon-chevron_down"></i>
                                        </button>
                                        <span class="rs-body-xs-I" style="margin-left:8px;">Show all fields</span>
                                    </div> --]]

                                </div> <!--  close container -->

                                <div class="container-fluid rs-summary-section rs-background-p10">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Pages</span>
                                        </bs-col>

                                    </bs-row> <!--  close row -->

                                    <bs-row class="row-center">
                                        <bs-col xs=11 sm=10 md=10 lg=8 class="rs-summary-table">
                                            <div class="table-responsive rs-table">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">Modified</th>
                                                            <th scope="col">Page type</th>
                                                            <th scope="col">Link</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>12.12.2018</td>
                                                            <td>Narrative</td>
                                                            <td><a>page link</a></td>
                                                        </tr>
                                                        <tr>
                                                            <td>12.12.2018</td>
                                                            <td>Narrative</td>
                                                            <td><a>page link</a></td>
                                                        </tr>
                                                        <tr>
                                                            <td>12.12.2018</td>
                                                            <td>Narrative</td>
                                                            <td><a>page link</a></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <div class="rs-section-showall">
                                        <button type="button" class="rs-button rs-button-icon-M--dark">
                                            <i class="rs-icon rs-icon-chevron_down"></i>
                                        </button>
                                        <span class="rs-body-xs-I" style="margin-left:8px;">Show all fields</span>
                                    </div>

                                </div> <!--  close container -->

                                <div class="container-fluid rs-page-section">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Assertions</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    <bs-row style="margin: 0;">
                                        <bs-col xs=12 class="rs-section-cards">
                                            [[#block "relatedAssertions"]]
                                            [[/block]]
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                </div> <!--  close container -->

                                <div class="container-fluid rs-summary-section rs-background-p10">
                                    <bs-row>
                                        <bs-col xs=12 style="padding: 0;">
                                            <hr class="rs-header-line">
                                            <span class="rs-h1 rs-section-header">Wikidata</span>
                                        </bs-col>
                                    </bs-row> <!--  close row -->

                                    [[#block "relatedWikidata"]]
                                    [[/block]]

                                </div> <!--  close container -->
                            </bs-tab-pane>
                            [[/if]]

                        </bs-tab-content>
                    </div>
                </bs-tab-container>
            </div>
        </div>
    </template>
</with-types>
[[/if]]

[[#*inline "resourceHeaderData"]]
[[#block "headerData"]]
<!-- RESOURCE LABEL-->
<!-- <div class="rs-resource-header--singletitle">
    <div class="rs-display3 rs-resource-header--title" style="text-transform: capitalize;">
        <mp-label iri='[[this]]'></mp-label>
    </div>
</div> -->
<!-- DATA ON PAGE HEADER (right by the image) -->
<semantic-table query=' SELECT DISTINCT ?artist ?artistLabel ?id_number ?geonames ?recto_title_1938 ?verso_title_1938 ?recto_title_1961 ?verso_title_1961 ?location ?locationLabel
WHERE {
    
    ## LOCATION ##
    OPTIONAL {
        <[[this]]>  crm:P30_custody_transferred_through ?transfer.
        ?transfer crm:P29_custody_recieved_by ?location.
        ?location rdfs:label ?locationLabel.
        ?location crm:P74_has_current_or_former_resindence ?geonames.
    }
    
    ## PREFERRED IDENTIFIER (Inventory Number) ##
    OPTIONAL {
        <[[this]]> crm:P48_has_preferred_identifier ?id .
        ?id rdfs:label ?id_number
    }        

    ## RECTO TITLE 1938 (Title) ##
    OPTIONAL {
    <[[this]]> crm:P56_bears_feature ?feature.
    ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
    ?feature a crm:E25_Man-Made_Feature.
    ?feature crm:P138_has_representation ?visual_item.
    ?visual_item a crm:E36_Visual_Item.
    ?visual_item crm:P102_has_title ?value_uri.
    ?value_uri a crm:E35_Title.
    ?value_uri rdfs:label ?recto_title_1938.
    ?value_uri crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>
    }

    ## VERSO TITLE 1938 (English Title) ##
    OPTIONAL {
        <[[this]]> crm:P56_bears_feature ?feature_vb.
        ?feature_vb crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
        ?feature_vb crm:P138_has_representation ?visual_item_vb.
        ?visual_item_vb a crm:E36_Visual_Item.
        ?visual_item_vb crm:P102_has_title ?value_uri_vb.
        ?value_uri_vb a crm:E35_Title.
        ?value_uri_vb rdfs:label ?verso_title_1938.
        ?value_uri_vb crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1938/attribute_assignment>.
    }

    ## RECTO TITLE 1961 (English Title) ##
    OPTIONAL {
    <[[this]]> crm:P56_bears_feature ?feature_b.
    ?feature_b crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
    ?feature_b a crm:E25_Man-Made_Feature.
    ?feature_b crm:P138_has_representation ?visual_item_b.
    ?visual_item_b a crm:E36_Visual_Item.
    ?visual_item_b crm:P102_has_title ?value_uri_b.
    ?value_uri_b a crm:E35_Title.
    ?value_uri_b rdfs:label ?recto_title_1961.
    ?value_uri_b crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1961/attribute_assignment>
    }
    
    ## VERSO TITLE 1961 (English Title) ##
    OPTIONAL {
        <[[this]]> crm:P56_bears_feature ?feature_va.
        ?feature_va crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
        ?feature_va crm:P138_has_representation ?visual_item_va.
        ?visual_item_va a crm:E36_Visual_Item.
        ?visual_item_va crm:P102_has_title ?value_uri_va.
        ?value_uri_va a crm:E35_Title.
        ?value_uri_va rdfs:label ?verso_title_1961.
        ?value_uri_va crm:P141i_was_assigned_by <https://florentinedrawings.itatti.harvard.edu/resource/work/1961/attribute_assignment>.
    }

}' options='{"showFilter":false}' tuple-template='{{>headerDefaultData}}'>

    <template id="headerDefaultData">
        <div>
            <bs-col>
                <div data-flex-layout="row md-column center-stretch">
                  <bs-row>
                    <div>
                                    
                        {{#ifCond id_number.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Inventory Number: </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                {{id_number.value}}
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        {{#ifCond recto_title_1961.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Recto Title (1961): </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                {{recto_title_1961.value}}
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        {{#ifCond verso_title_1961.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Verso Title (1961): </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                {{verso_title_1961.value}}
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        {{#ifCond recto_title_1938.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Recto Title (1938): </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                {{recto_title_1938.value}}
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        {{#ifCond verso_title_1938.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Verso Title (1938): </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                {{verso_title_1938.value}}
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        <semantic-query query='
                        SELECT DISTINCT ?artist ?label WHERE {
                            <[[this]]> crm:P108i_was_produced_by ?production.
                            ?production crm:P01i_is_domain_of ?domain.
                            ?domain crm:P02_has_range ?artist.
                            ?artist rdfs:label ?artistLabel.
                             {
                                ?domain a crm:PC15_was_influenced_by.
                                ?domain crm:P15.1_in_the_role_of ?qualifier.
                                ?qualifier rdfs:label ?qualifierLabel.
                             } union {
                                FILTER NOT EXISTS{ ?domain a crm:PC15_was_influenced_by.}
                                BIND("by" as ?qualifierLabel)
                              } 
                            BIND(CONCAT(?artistLabel," (",?qualifierLabel,")") as ?label)
                             FILTER(regex(str(?domain),"/1961"))   
                          }
                        ' 
                        template="{{> artistTemplate}}"
                        > 
                        <template id="artistTemplate">
                            {{#each bindings}}
                            {{#ifCond artist.value "!==" undefined}}
                            <bs-col lg="5" md="12"> 
                                <div class="grid-demo"> 
                                    <b>Artist Attribution (1961): </b>
                                </div> 
                            </bs-col>
                            <bs-col md="7">
                                <div class="grid-demo">
                                    <semantic-link iri={{artist.value}}>{{label.value}}</semantic-link>
                                </div>
                            </bs-col>
                            {{/ifCond}}
                            {{/each}}
                        </template>
                        </semantic-query>


                        {{#ifCond recto_title_1961.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Recto Technique: </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                <semantic-query query='  
                                SELECT ?technique  WHERE{
                                <[[this]]> crm:P56_bears_feature ?feature.
                                ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                ?feature a crm:E25_Man-Made_Feature.
                                ?feature crm:P81_was_modified_by ?modification.
                                ?modification a crm:E11_Modification.
                                ?modification crm:P32_used_general_technique ?technique.
                                }'> {{technique}} </semantic-query>
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        {{#ifCond verso_title_1961.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Verso Technique: </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                <semantic-query query='  
                                SELECT ?technique  WHERE{
                                <[[this]]> crm:P56_bears_feature ?feature.
                                ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300010292>.
                                ?feature a crm:E25_Man-Made_Feature.
                                ?feature crm:P81_was_modified_by ?modification.
                                ?modification a crm:E11_Modification.
                                ?modification crm:P32_used_general_technique ?technique.
                                }'> {{technique}} </semantic-query>
                            </div>
                        </bs-col>
                        {{/ifCond}}

                        {{#ifCond location.value "!==" undefined}}
                        <bs-col lg="5" md="12"> 
                            <div class="grid-demo"> 
                                <b>Location: </b>
                            </div> 
                        </bs-col>
                        <bs-col md="7">
                            <div class="grid-demo">
                                <semantic-link iri={{location.value}}></semantic-link>
                            </div>
                        </bs-col>
                        {{/ifCond}}
                        <bs-col md="12">
                            <div class="grid-demo">
                                <b>Data sources: </b>
                                <div style="display:flex; flex-wrap: nowrap; margin-top: 8px;" class="row">
                            {{#ifCond location.value "!==" undefined}}
                            <div style="margin-right:1vw">
                              <a target="_null" title={{locationLabel.value}} href={{location.value}}>
                                  <img class="dataSourceIcon" alt="VIAF" src="../../assets/images/viaf_source.png">
                              </a>
                            </div>
                            <div style="margin-right:1vw">
                                <a target="_null" title={{locationLabel.value}} href={{geonames.value}}>
                                    <img class="dataSourceIcon" alt="GeoNames" src="../../assets/images/geonames_source.png">
                                </a>
                              </div>
                            {{/ifCond}}
                            <div style="margin-right:1vw">
                                {{#ifCond artist.value "!==" undefined}}
                                <a target="_null" title={{artistLabel.value}} href={{artist.value}}>
                                    <img class="dataSourceIcon" alt="ULAN" src="../../assets/images/ulan_source.png">
                                </a>
                                {{/ifCond}}
                            </div>
                            <div style="margin-right:1vw">
                                {{#ifCond recto_title_1961.value "!==" undefined}}
                                <div style="display: flex;">
                                  <semantic-query query='  
                                        SELECT DISTINCT ?technique ?techniqueLabel  WHERE{
                                        <[[this]]> crm:P56_bears_feature ?feature.
                                        ?feature crm:P2_has_type <http://vocab.getty.edu/aat/300078817>.
                                        ?feature a crm:E25_Man-Made_Feature.
                                        ?feature crm:P81_was_modified_by ?modification.
                                        ?modification a crm:E11_Modification.
                                        ?modification crm:P32_used_general_technique ?technique.
                                        ?technique rdfs:label ?techniqueLabel
                                        }'
                                        template="{{> aatDataSource}}"
                                        ><template id="aatDataSource">
                                            {{#each bindings}}
                                            <div style="margin-right:1vw"><a target="_null" title={{techniqueLabel.value}} href="{{technique.value}}">  
                                                <img class="dataSourceIcon" alt="AAT" src="../../assets/images/aat_source.png">
                                              </a></div>
                                            {{/each}}
                                        </template>    
                                    </semantic-query>
                                </div>
                                {{/ifCond}}
                              </div>  
                        </div>
                          
                            </div>
                        </bs-col>
                    </div>
                  </bs-row>
                </div>
            </bs-col>
        </div>
    </template>
</semantic-table>
  

[[/block]]
[[/inline]]

<style>
    .mirador-main-menu-bar{
    display: none !important;
    }

    .mirador-viewer{
        top: 0px !important;
    }
    .mirador-osd-annotation-controls{
        display: none !important;
    }
    a.mirador-icon-window-menu{
        display: none !important;
    }

    .griddle-custom-row{
        display: unset !important;
    }
    
    .grid-demo{
        display: flex;
        flex-direction: column;
        padding: 8px;
        border-radius: 3px;
        font-size: medium;
        margin: 0.5vh;
        min-width:14vw;
    }
    .grid-demo b{
        font-weight: 500 !important;
    color: #636363 !important;
    }
    .grid-demo:hover{
        box-shadow: 0px 2px 4px 0px #ededed;
    }

    .rs-summary-table{
        margin: 2vh;
        box-shadow: 0px 1px 4px 0px lightgrey;
        padding: 1vh;
        border-radius: 4px;
    }

    .rs-page__summary-image{
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        cursor: pointer;
    }
    .rs-page__summary-image .subtitle{
        text-align: center;
        margin: 10px 0px 10px 0px;
        text-decoration: none !important;
        color:#636363 !important;
    }
    .subtitle{
        text-align: center;
        margin: 10px 0px 10px 0px;
        text-decoration: none !important;
        color:#636363 !important;
    }
    .rs-page__summary-image img{
        min-height: 35vh;
        max-height: 38vh;
    }
    .miradorViewerPopup .grid-demo{
        height: 92vh;
    }
    .miradorViewerPopup .modal-dialog{
        width: 85%;
    }
    .miradorViewerPopup .modal-title{
        text-align: center;
    }
    .dataSourceIcon{
        border-radius: 5px; 
        box-shadow: 1px 1px 1px 1px #ededed; 
        height: 5vh;
    }
    .dataSourceIcon:hover{
        transition: 0.2s ease-in;
        filter: contrast(0.8);
    }
    .mirador .researchspace-mirador.mirador-container .mirador-osd-toggle-bottom-panel {
    display: none;
    }
</style>
